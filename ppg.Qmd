---
title: "PPG"
format:
  gfm:
    toc: false
    wrap: none
params:
  tax_taxonRank: "species"
execute: 
  echo: false
  message: false
  warning: false
---

```{r}
#| label: setup
source(here::here("R/packages.R"))
source(here::here("R/functions.R"))
library(glue)
library(tidyverse)
library(assertr)
library(taxlist)
library(taxnames)
conflicted::conflict_prefer("filter", "dplyr")

tar_load(c(ppg_taxdf), store = here::here("_targets"))
```

```{r}
#| label: ppg-treatment
#| results: asis
ppg_taxdf |>
  mutate(
    formatted_name = case_when(
      taxonRank == "genus" ~ glue::glue(
        "*{scientificName}* {scientificNameAuthorship}"),
      taxonRank != "genus" ~ glue::glue(
        "{indent} {str_to_sentence(taxonRank)} **{scientificName}** {scientificNameAuthorship}"
      ),
      .default = NA_character_
    ),
    formatted_name = as.character(formatted_name)
  ) |>
  pull(formatted_name) |>
  cat(sep = "\n\n")
```
